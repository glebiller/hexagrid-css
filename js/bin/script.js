function h(a,b,c,f,e,d){var g=b%2?0:1;this.w=$('<div class="flip" data-flipped="false"><div class="face front"><img src="img/hexa.png" width="'+f+'" height="'+e+'"></div><div class="face back"><img src="img/hexa_flipped.png" width="'+f+'" height="'+e+'" /></div></div>');this.r=!1;this.o=null;this.z=d;this.index=b*a+c;this.g=0===c?-1:this.index-1;this.j=c===a-1?-1:this.index+1;this.i=0===c&&0===g?-1:this.index-a+g-1;this.h=0===c&&0===g?-1:this.index+a+g-1;this.l=c===a-1&&1===g?-1:this.index-a+g;this.k=
c===a-1&&1===g?-1:this.index+a+g}function k(a){a.o=setTimeout($.proxy(a.f,a,!1),a.z)}h.prototype.f=function(a){var b;if(this.r){if(a){clearTimeout(this.o);k(this);return}b="0deg";clearTimeout(this.o)}else{if(!a)return;b="180deg";k(this)}this.r=a;this.w.css("transform","rotate3d(1, 1, 0, "+b+")")};function l(a,b,c,f){this.a=null;this.c=[];this.A=b;this.m=3*b/4;this.e=c;this.s=c/2;this.u=c/4;this.b=Math.round(a.height()/this.e)+1;this.p=Math.round(a.width()/this.m)+1;this.v=null;for(a=0;a<this.p;++a)for(b=0;b<this.b;++b)c=new h(this.b,a,b,this.A,this.e,f),this.c[c.index]=c}function m(a,b,c){b+=a.s;var f=Math.floor(b/a.m),e=0===f%2;c=e?c:c+a.s;var d=Math.floor(c/a.e);b-=f*a.m;c-=d*a.e;b+c/2<a.u?(--f,e||--d):b-c/2<-a.u&&(--f,e&&++d);return f*a.b+d}
l.prototype.t=function(a,b){var c=this,f=a.shift(),e=[],d;$.each(f,function(){if(d=c.c[this]){if(d)switch(d.index){case b.index:e.push(d.j,d.l,d.k,d.g,d.h,d.i);break;case b.g:e.push(d.g,d.h);break;case b.h:e.push(d.h,d.k);break;case b.k:e.push(d.k,d.j);break;case b.j:e.push(d.j,d.l);break;case b.l:e.push(d.l,d.i);break;case b.i:e.push(d.i,d.g)}d.f(!0)}});e.length&&a.push(e);a.length&&setTimeout($.proxy(this.t,this,a,b),125)};
l.prototype.modeClicking=function(a){var b=this.c[m(this,a.pageX,a.pageY)];this.t([[b.index]],b);return a.preventDefault()};l.prototype.modeDrawing=function(a){var b=m(this,a.pageX,a.pageY);this.v!==b&&(this.v=b,this.c[b].f(!0));return a.preventDefault()};l.prototype.reset=function(){$(this.c).each(function(){this.f(!1)})};
l.prototype.n=function(a){this.a=a;a=[];var b,c;for(b=0;b<this.p;++b){a[b]=$('<div class="flips"></div>');for(c=0;c<this.b;++c)a[b].append(this.c[b*this.b+c].w)}this.a.css({width:this.p*this.m,height:this.b*this.e}).html(a);return this};function n(a){this.a=null;this.d=a;this.elements=$('<a href="javascript:void(0);" class="modeClicking">Clicking Mode</a>').click($.proxy(this.q,this,"click","modeClicking")).add($('<a href="javascript:void(0);" class="modeDrawing">Drawing Mode</a>').click($.proxy(this.q,this,"mouseover","modeDrawing"))).add($("<hr />")).add($('<a href="javascript:void(0);">Reset</a>').click($.proxy(this.d.reset,this.d)))}
n.prototype.q=function(a,b){this.elements.removeClass("active").filter("."+b).addClass("active");this.d.a.unbind().bind(a,$.proxy(this.d[b],this.d))};n.prototype.n=function(a){this.a=a;this.a.append(this.elements);this.q("click","modeClicking")};(function(){var a=$(window),b=new l(a,100,88,5E3),c=new n(b);$(document).ready(function(){$("#viewport").css({width:a.width(),height:a.height()});b.n($("#grid"));c.n($("#menu"))})})();
